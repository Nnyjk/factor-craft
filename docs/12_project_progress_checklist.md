# 12. 项目进度 Checklist（按里程碑推进）

> 依据：`docs/06_implementation_api.md` 的 M1~M5、`docs/10_command_mvp.md` 与 `docs/11_foundation_baseline.md` 的 M0 地基、`docs/07_module_architecture.md` 的模块边界。  
> 使用方式：每周/每迭代对照本清单更新状态；建议状态标记为 `未开始 / 进行中 / 已完成 / 风险`。

---

## 0) 当前基线快照（2026-02）

- [x] 动态内容加载主链路已具备：`configs/textures/models/lang/commands` 纳入统一加载与热更新。
- [x] 模块化启动框架已具备：`ModuleBootstrap` + 统一模块初始化。
- [x] M0 命令系统基础骨架已落地（模型/校验器/注册中心/执行结果对象）。
- [ ] M1~M5 业务逻辑大多仍处于“骨架 + 接口预留”阶段，尚未进入完整玩法实现。

---

## M0（基础地基：命令 MVP + 生命周期）

### M0.1 已完成项（对齐 docs/11）
- [x] 模块生命周期：`initialize/reload/shutdown`。
- [x] 模块依赖声明与校验流程。
- [x] `commands.json` 纳入 `DynamicBundle`。
- [x] 命令注册与受控 handler 机制（不支持任意脚本执行）。

### M0.2 收尾与增强（建议下一个迭代完成）
- [x] 补齐事件总线基础契约（优先级、错误传播、同步/异步边界）。
- [x] 明确权限与审计标准文档（命令安全策略、审计字段、留存策略）。
- [x] 为 registry/validator 增加纯 JVM 单元测试。
- [x] 建立命令配置变更的回归检查（schema + validator + 示例配置）。

**M0 验收标准**
- [x] 新增命令可通过“配置 + handler 注册”完成接入。
- [x] 非法命令配置在启动阶段可被阻断并给出可读错误。
- [x] 命令执行链路具备最小可观测性（结果码、调用来源、失败原因）。

---

## M1（Factor + Tier + 日切，含 M1b 怪物/掉落联动）

### M1 核心能力（Factor 系统）
- [x] `FactorWorldState`：实时因子更新（含潮汐、玩家偏移、噪声、阻尼）。
- [x] `DayTierSnapshot`：日切结算（`F_dayAvg`、趋势、迟滞参数）。
- [x] Tier 判定与边界事件广播（`FactorTierChangeEvent` / `FactorThresholdEvent`）。
- [x] HUD / 调试可视化（至少含当前 Factor、今日均值、明日 Tier 预测）。
- [x] 冷却与灾害触发状态管理（`EventCooldownState` / `FactorDisasterEvent`）。

### M1b 扩展能力（怪物生态与凋落物）
- [x] 刷新规则注册与按维度/Tier 过滤查询。
- [x] 掉落池注册与按实体/Tier 切换。
- [x] 阶段能力（高能/过载）触发框架。
- [x] 日切后刷新规则与掉落池自动切换。

**M1 验收标准**
- [ ] 单日内 Factor 波动可观测，跨日 Tier 变化符合阈值规则。
- [ ] 边界事件可触发且有冷却保护。
- [ ] M1b 规则在不同 Tier 下能稳定切换并落日志。

---

## M2（材料分级 / 词条 / 附魔 / 状态系统）

- [x] 材料等级模型（Lv1~Lv5）与基础属性（导因率、韧性、槽位等）。
- [x] 词条池：通用词条 + 维度词条 + 终局词条。
- [x] 附魔池：武器/工具/防具三类。
- [x] BUFF/DEBUFF 状态池与叠加规则。
- [x] 与 Tier 日切联动（状态池结算、装备词条修正）。
- [x] 数值配置数据化（JSON）与校验。

**M2 验收标准**
- [x] 材料与词条生成可复现（相同 seed/规则下结果一致）。
- [x] 状态效果具备明确来源、持续时间与数值展示。
- [x] 至少 1 条完整“材料 -> 词条 -> 附魔 -> 状态联动”演示链路可运行。

---

## M3（科技树 / 多方块 / 功率预算）

- [ ] 多方块蓝图定义与完整性检查。
- [ ] `StructureState`：结构状态、模块槽、功率预算。
- [ ] `StructureApi.getPowerBudget` 等核心接口可用。
- [ ] 模块化升级（稳定器/缓存器/散热器等）与预算影响。
- [ ] 结构故障与恢复机制（高压/过载下）。

**M3 验收标准**
- [ ] 至少 1 套多方块机器从建造到运行全流程可完成。
- [ ] 功率预算变化可被观测并驱动性能差异。
- [ ] 结构故障可复现、可恢复、可审计。

---

## M4（战斗装备 / 饰品 / 特殊能力）

- [ ] 武器、防具、饰品标准化能力模型。
- [ ] `GearApi` 能力触发与导因消耗机制。
- [ ] `GearAbilityEvent` / `TrinketProcEvent` 接入战斗与状态系统。
- [ ] 飞行/位移/护盾等能力的冷却、消耗、风控。
- [ ] 与 M1~M3 的联动（Tier 窗口、结构供能、状态增减益）。

**M4 验收标准**
- [ ] 关键能力（至少飞行或位移）在受控条件下稳定触发。
- [ ] 能力收益与风险平衡（高收益伴随可量化代价）。
- [ ] PvE 场景下具备可验证的 build 差异。

---

## M5（建筑 / 家具 / 装饰 + 社交玩法）

- [ ] 建材/家具/装饰标准属性落地（舒适度、功能加成、区域标签）。
- [ ] 区域玩法联动（基地稳定度、生产/恢复增益）。
- [ ] 服务器向社交机制（协作建造、区域任务、共享加成）。
- [ ] 与非核心接入标准打通（第三方家具/建材可接入）。

**M5 验收标准**
- [ ] 建筑与家具不只“外观”，能对玩法形成可量化影响。
- [ ] 多人协作可获得差异化收益（不只是数值堆叠）。
- [ ] 至少 1 条“基地建设 -> 稳定收益 -> 生态反馈”闭环成立。

---

## 横向保障清单（每个里程碑都执行）

### 工程质量
- [ ] 每个模块至少具备：模型校验测试 + 核心流程测试。
- [ ] API 变更要同步文档与示例配置。
- [ ] 对外接口保持向后兼容策略（或明确 breaking change）。

### 数据驱动
- [ ] 所有核心数值进入 JSON 配置并配套 validator。
- [ ] 配置热更新需要明确“可热更/需重启”边界。
- [ ] 配置错误可定位到字段级别（含来源文件名）。

### 可观测性
- [ ] 关键事件统一日志字段（模块、实体、Tier、耗时、结果码）。
- [ ] 为日切、阈值跨越、能力触发建立最小统计指标。
- [ ] 预留导出接口以支持后续平衡性分析。

### 风险管理
- [ ] 每个里程碑识别 Top3 风险并设置 fallback 方案。
- [ ] 对性能敏感路径（tick 更新、批量查询、事件广播）做基准测试。
- [ ] 在联机场景验证状态一致性（客户端/服务端）。

---

## 建议推进节奏（可直接执行）

- **Sprint A（1~2 周）**：完成 M0.2（事件契约 + 审计 + 单测基础）。
- **Sprint B（2~3 周）**：推进 M1 核心（日切 + Tier + 阈值事件 + HUD 调试）。
- **Sprint C（1~2 周）**：补齐 M1b（怪物刷新/掉落按 Tier 切换）。
- **Sprint D（2~3 周）**：完成 M2 首版（材料/词条/状态最小闭环）。
- **Sprint E（2~3 周）**：完成 M3 首套多方块与功率预算。
- **Sprint F（2~3 周）**：完成 M4 核心能力（飞行/位移二选一先上线）。
- **Sprint G（2~3 周）**：完成 M5 核心玩法闭环并联调非核心接入。

> 建议在每个 Sprint 末进行一次“验收标准逐条勾选 + 风险复盘”。
